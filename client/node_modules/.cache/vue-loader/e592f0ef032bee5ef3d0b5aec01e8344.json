{"remainingRequest":"/home/huhe/flask123/flask_book/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/huhe/flask123/flask_book/client/src/components/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/huhe/flask123/flask_book/client/src/components/Home.vue","mtime":1584964945541},{"path":"/home/huhe/flask123/flask_book/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/huhe/flask123/flask_book/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/huhe/flask123/flask_book/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/huhe/flask123/flask_book/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g5a2Y5pS+5ZCO56uv55qE5Lmm57GNCiAgICAgIGJvb2tzOiBbXSwKICAgICAgLy8g5re75Yqg5Lmm57GN55qE5a+56K+d5qGGCiAgICAgIGFkZEJvb2tWaXNpYmxlOiBmYWxzZSwKICAgICAgLy8g5a2Y5pS+5re75Yqg5Lmm57GN6KGo5qC85pWw5o2uCiAgICAgIGFkZEJvb2tGb3JtOiB7CiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIGF1dGhvcjogIiIsCiAgICAgICAgcmVhZDogZmFsc2UKICAgICAgfSwKICAgICAgLy8g5re75Yqg5Lmm57GN6KeE5YiZCiAgICAgIGFkZEJvb2tSdWxlczogewogICAgICAgIHRpdGxlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeS5puexjeWQjeensCIsIHRyaWdnZXI6ICJibHVyIiB9XSwKICAgICAgICBhdXRob3I6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5L2c6ICF5ZCN56ewIiwgdHJpZ2dlcjogImJsdXIiIH1dCiAgICAgIH0sCiAgICAgIC8vIOe8lui+keS5puexjeWvueivneahhgogICAgICBlZGl0Qm9va1Zpc2libGU6IGZhbHNlLAogICAgICAvLyDlrZjmlL7nvJbovpHkuabnsY3nmoTlr7nosaEKICAgICAgZWRpdEZvcm06IHt9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0Qm9va3MoKSB7CiAgICAgIC8vIOiOt+WPluS5puexjQogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLmdldCgiYm9va3MiKTsKICAgICAgLy8gY29uc29sZS5sb2cocmVzKTsKICAgICAgLy8gY29uc29sZS5sb2cocmVzLnN0YXR1cykKICAgICAgLy8gY29uc29sZS5sb2cocmVzLnN0YXR1cykKICAgICAgdGhpcy5ib29rcyA9IHJlcy5kYXRhOwogICAgfSwKICAgIGFkZEJvb2soKSB7CiAgICAgIHRoaXMuJHJlZnMuYm9va1JlZi52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuOwogICAgICAgIC8v5re75Yqg5Lmm57GN6K+35rGCCiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCJhZGQiLCB0aGlzLmFkZEJvb2tGb3JtKTsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIC8vIOi/memHjOWIpOaWreimgeWKoOW8leWPtycnIOaVsOWtl+aXoOazleivhuWIqwogICAgICAgIGlmIChyZXMuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIua3u+WKoOS5puexjeWksei0pSIpOwogICAgICAgIH0KICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIua3u+WKoOS5puexjeaIkOWKnyIpOwogICAgICAgIHRoaXMuYWRkQm9va1Zpc2libGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmdldEJvb2tzKCk7CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOa4heepuua3u+WKoOS5puexjei+k+WFpeahhgogICAgYWRkRGlhbG9nQ2xvc2VkKCkgewogICAgICB0aGlzLiRyZWZzLmJvb2tSZWYucmVzZXRGaWVsZHMoKTsKICAgIH0sCgogICAgLy8g57yW6L6R5Lmm57GN5a+56K+d5qGGCiAgICBhc3luYyBzaG93RWRpdERpYWxvZyhpZCkgewogICAgICAvLyBjb25zb2xlLmxvZyhpZCkKICAgICAgY29uc3QgcmVzID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoInNob3dib29rcy8iICsgaWQpOwogICAgICAvLyDnnItyZXMuZGF0YSDkvJrlj5HnjrDlh7rnjrDkuoYgX19vYl9fOiBPYnNlcnZlcgogICAgICAvLyDov5nmmK92dWUg6YeM55qE54m55oCnCiAgICAgIGNvbnNvbGUubG9nKHJlcyk7CiAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhWzBdKTsKICAgICAgaWYgKHJlcy5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCLmn6Xor6LkuabnsY3lpLHotKUiKTsKICAgICAgfQogICAgICAvLyDluKYgWzBdIOWPr+S7peaJjeiDveiOt+W+l+aVsOaNrgogICAgICB0aGlzLmVkaXRGb3JtID0gcmVzLmRhdGFbMF07CgogICAgICB0aGlzLmVkaXRCb29rVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgLy8g55uR5ZCs5Lmm57GN5L+u5pS55a+56K+d5qGG55qE5YWz6Zet5LqL5Lu2CiAgICBlZGl0RGlhbG9nQ2xvc2VkKCkgewogICAgICB0aGlzLiRyZWZzLmVkaXRGb3JtUmVmLnJlc2V0RmllbGRzKCk7CiAgICB9LAogICAgLy8g5L+u5pS55Lmm57GN5L+h5oGvCiAgICBlZGl0Qm9va0luZm8oKSB7CiAgICAgIHRoaXMuJHJlZnMuZWRpdEZvcm1SZWYudmFsaWRhdGUoYXN5bmMgdmFsaWQgPT4gewogICAgICAgIGlmICghdmFsaWQpIHJldHVybjsKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmVkaXRGb3JtKTsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRodHRwLnBvc3QoCiAgICAgICAgICAiZWRpdGJvb2tzLyIgKyB0aGlzLmVkaXRGb3JtLmlkLAogICAgICAgICAgdGhpcy5lZGl0Rm9ybQogICAgICAgICk7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKICAgICAgICBpZiAocmVzLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi5L+u5pS55aSx6LSlIik7CiAgICAgICAgfQoKICAgICAgICAvL+WFs+mXreWvueivneahhiDliLfmlrDpobXpnaIg5o+Q56S65L+u5pS55oiQ5YqfCiAgICAgICAgdGhpcy5lZGl0Qm9va1Zpc2libGUgPSBmYWxzZTsKICAgICAgICB0aGlzLmdldEJvb2tzKCk7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLkv67mlLnmiJDlip8iKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5Yig6Zmk5Lmm57GNIOagueaNrmlk5YC8CiAgICBhc3luYyBkZWxldGVCb29rKGlkKSB7CiAgICAgIC8vIOW8ueahhuaPkOekuueUqOaIt+WIoOmZpOS5puexjQogICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRjb25maXJtKAogICAgICAgICLmraTmk43kvZzlsIbmsLjkuYXliKDpmaTor6XkuabnsY0sIOaYr+WQpue7p+e7rT8iLAogICAgICAgICLmj5DnpLoiLAogICAgICAgIHsKICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgICAgdHlwZTogIndhcm5pbmciCiAgICAgICAgfQogICAgICApLmNhdGNoKGVyciA9PiBlcnIpOwogICAgICAvLyDlpoLmnpznlKjmiLfnoa7orqTliKDpmaQg5YiZ6L+U5ZueY29uZmlybSDlj5bmtojov5Tlm55jYW5jZWwKCiAgICAgIGlmIChyZXMgIT09ICJjb25maXJtIikgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmluZm8oIuW3suWPlua2iOWIoOmZpCIpOwogICAgICB9CgogICAgICBjb25zdCByZXMyID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCJkZWxldGUvIiArIGlkKTsKICAgICAgaWYgKHJlczIuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi5Yig6Zmk5aSx6LSlIik7CiAgICAgIH0KCiAgICAgIHRoaXMuZ2V0Qm9va3MoKTsKICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Yig6Zmk5oiQ5YqfIik7CiAgICB9CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Qm9va3MoKTsKICB9Cn07Cg=="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"home_container\">\n    <el-container>\n      <el-header>图书馆</el-header>\n      <el-main>\n        <!-- 添加书籍按钮 -->\n        <div style=\"text-align:center\">\n          <el-button type=\"primary\" @click=\"addBookVisible = true\" round>添加书籍</el-button>\n        </div>\n\n        <!-- 书籍表格 -->\n        <div style=\"margin-top:20px; width:700px\">\n          <el-table :data=\"books\" style=\"width: 100%\">\n            <el-table-column label=\"书名\" width=\"180\">\n              <template slot-scope=\"scope\">\n                <i class=\"el-icon-reading\"></i>\n                <span style=\"margin-left: 10px\">{{ scope.row.title }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"作者\" width=\"180\">\n              <template slot-scope=\"scope\">\n                <i class=\"el-icon-user-solid\"></i>\n                <span style=\"margin-left: 10px\">{{ scope.row.author }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"是否已读\" width=\"180\">\n              <template slot-scope=\"scope\">\n                <span style=\"margin-left: 10px\">\n                  <el-button type=\"primary\" v-if=\"scope.row.read\">已读</el-button>\n                  <el-button type=\"danger\" v-else>未读</el-button>\n                </span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\">\n              <template slot-scope=\"scope\">\n                <el-button size=\"mini\" @click=\"showEditDialog(scope.row.id)\">编辑</el-button>\n                <el-button size=\"mini\" type=\"danger\" @click=\"deleteBook(scope.row.id)\">删除</el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n      </el-main>\n    </el-container>\n\n    <!-- 添加书籍对话框 -->\n    <el-dialog title=\"添加书籍\" :visible.sync=\"addBookVisible\" width=\"30%\" @close=\"addDialogClosed\">\n      <el-form ref=\"bookRef\" :model=\"addBookForm\" :rules=\"addBookRules\" label-width=\"80px\">\n        <el-form-item label=\"书籍名称\" prop=\"title\">\n          <el-input v-model=\"addBookForm.title\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"作者名称\" prop=\"author\">\n          <el-input v-model=\"addBookForm.author\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"是否读过\">\n          <el-switch v-model=\"addBookForm.read\"></el-switch>\n        </el-form-item>\n      </el-form>\n\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addBookVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addBook\">确 定</el-button>\n      </span>\n    </el-dialog>\n\n    <!--编辑对话框 -->\n    <el-dialog title=\"编辑\" :visible.sync=\"editBookVisible\" width=\"30%\" @close=\"editDialogClosed\">\n      <el-form ref=\"editFormRef\" :model=\"editForm\" :rules=\"addBookRules\" label-width=\"80px\">\n        <el-form-item label=\"书籍名称\" prop=\"title\">\n          <el-input v-model=\"editForm.title\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"作者名称\" prop=\"author\">\n          <el-input v-model=\"editForm.author\"></el-input>\n        </el-form-item>\n        \n        <el-form-item label=\"是否读过\">\n          <el-switch v-model=\"editForm.read\" active-color=\"#13ce66\" inactive-color=\"#ff4949\"></el-switch>\n        </el-form-item>\n\n      </el-form>\n\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"editBookVisible = false\">取 消</el-button>\n        <el-button @click=\"editBookInfo\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      // 存放后端的书籍\n      books: [],\n      // 添加书籍的对话框\n      addBookVisible: false,\n      // 存放添加书籍表格数据\n      addBookForm: {\n        title: \"\",\n        author: \"\",\n        read: false\n      },\n      // 添加书籍规则\n      addBookRules: {\n        title: [{ required: true, message: \"请输入书籍名称\", trigger: \"blur\" }],\n        author: [{ required: true, message: \"请输入作者名称\", trigger: \"blur\" }]\n      },\n      // 编辑书籍对话框\n      editBookVisible: false,\n      // 存放编辑书籍的对象\n      editForm: {}\n    };\n  },\n  methods: {\n    async getBooks() {\n      // 获取书籍\n      const res = await this.$http.get(\"books\");\n      // console.log(res);\n      // console.log(res.status)\n      // console.log(res.status)\n      this.books = res.data;\n    },\n    addBook() {\n      this.$refs.bookRef.validate(async valid => {\n        if (!valid) return;\n        //添加书籍请求\n        const res = await this.$http.post(\"add\", this.addBookForm);\n        console.log(res);\n        // 这里判断要加引号'' 数字无法识别\n        if (res.status !== 200) {\n          this.$message.error(\"添加书籍失败\");\n        }\n        this.$message.success(\"添加书籍成功\");\n        this.addBookVisible = false;\n        this.getBooks();\n      });\n    },\n    // 清空添加书籍输入框\n    addDialogClosed() {\n      this.$refs.bookRef.resetFields();\n    },\n\n    // 编辑书籍对话框\n    async showEditDialog(id) {\n      // console.log(id)\n      const res = await this.$http.get(\"showbooks/\" + id);\n      // 看res.data 会发现出现了 __ob__: Observer\n      // 这是vue 里的特性\n      console.log(res);\n      console.log(res.data[0]);\n      if (res.status !== 200) {\n        return this.$message.error(\"查询书籍失败\");\n      }\n      // 带 [0] 可以才能获得数据\n      this.editForm = res.data[0];\n\n      this.editBookVisible = true;\n    },\n    // 监听书籍修改对话框的关闭事件\n    editDialogClosed() {\n      this.$refs.editFormRef.resetFields();\n    },\n    // 修改书籍信息\n    editBookInfo() {\n      this.$refs.editFormRef.validate(async valid => {\n        if (!valid) return;\n        console.log(this.editForm);\n        const res = await this.$http.post(\n          \"editbooks/\" + this.editForm.id,\n          this.editForm\n        );\n        console.log(res);\n        if (res.status !== 200) {\n          return this.$message.error(\"修改失败\");\n        }\n\n        //关闭对话框 刷新页面 提示修改成功\n        this.editBookVisible = false;\n        this.getBooks();\n        this.$message.success(\"修改成功\");\n      });\n    },\n    // 删除书籍 根据id值\n    async deleteBook(id) {\n      // 弹框提示用户删除书籍\n      const res = await this.$confirm(\n        \"此操作将永久删除该书籍, 是否继续?\",\n        \"提示\",\n        {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }\n      ).catch(err => err);\n      // 如果用户确认删除 则返回confirm 取消返回cancel\n\n      if (res !== \"confirm\") {\n        return this.$message.info(\"已取消删除\");\n      }\n\n      const res2 = await this.$http.post(\"delete/\" + id);\n      if (res2.status !== 200) {\n        return this.$message.error(\"删除失败\");\n      }\n\n      this.getBooks();\n      return this.$message.success(\"删除成功\");\n    }\n  },\n\n  created() {\n    this.getBooks();\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.home_container {\n  background-color: #fff2df;\n  height: 100%;\n}\n.el-header {\n  text-align: center;\n  font-size: 40px;\n  margin-top: 20px;\n}\n.el-main {\n  margin: 0 auto;\n}\n</style>"]}]}